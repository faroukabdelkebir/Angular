<div class="container p-4 border rounded bg-light">
  <h2 class="text-center mb-4">Add New Residence</h2>
  <form [formGroup]="residenceForm" (ngSubmit)="onSubmit()">
    <input type="hidden" formControlName="id" />

    <div class="mb-3">
      <label for="name" class="form-label">Name</label>
      <input type="text" id="name" class="form-control" formControlName="name" />
      <div *ngIf="residenceForm.get('name')?.invalid && residenceForm.get('name')?.touched" class="text-danger">
        <small *ngIf="residenceForm.get('name')?.hasError('required')">Name is required.</small>
        <small *ngIf="residenceForm.get('name')?.hasError('minlength')">Minimum 3 characters.</small>
      </div>
    </div>

    <div class="mb-3">
      <label for="address" class="form-label">Address</label>
      <input type="text" id="address" class="form-control" formControlName="address" />
      <div *ngIf="residenceForm.get('address')?.invalid && residenceForm.get('address')?.touched" class="text-danger">
        <small>Address is required.</small>
      </div>
    </div>

    <div class="mb-3">
      <label for="image" class="form-label">Image URL</label>
      <input type="text" id="image" class="form-control" formControlName="image" />
      <div *ngIf="residenceForm.get('image')?.invalid && residenceForm.get('image')?.touched" class="text-danger">
        <small *ngIf="residenceForm.get('image')?.hasError('required')">Image URL is required.</small>
        <small *ngIf="residenceForm.get('image')?.hasError('pattern')">Invalid URL format.</small>
      </div>
    </div>

    <div class="mb-3">
      <label for="status" class="form-label">Status</label>
      <select id="status" class="form-select" formControlName="status">
        <option value="Disponible">Disponible</option>
        <option value="En Construction">En Construction</option>
        <option value="Vendu">Vendu</option>
      </select>
    </div>

    <!-- Appartements -->
    <div formArrayName="apartments">
      <div *ngFor="let apartment of apartments.controls; let i = index" [formGroupName]="i" class="mb-4 p-3 border rounded">
        <h4>Apartment {{ i + 1 }}</h4>
        <div class="row mb-3">
          <label class="col-sm-3 col-form-label">Apartment Number</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" formControlName="apartNum" />
          </div>
        </div>
        <!-- Ajoutez d'autres champs d'appartement ici -->
        <button type="button" class="btn btn-danger" (click)="removeApartment(i)">Remove</button>
      </div>
      <button type="button" class="btn btn-success mt-3" (click)="addApartment()">Add Apartment</button>
    </div>

    <div class="text-center mt-4">
      <button type="submit" class="btn btn-primary me-2" [disabled]="residenceForm.invalid">Submit</button>
      <button type="button" class="btn btn-secondary" (click)="onReset()">Reset</button>
    </div>
  </form>
</div>

